Fri Feb  2 18:27:36 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	Sync with savannah gawk cvsps 52.
	Arnold added the fmtspcl test to gawk-stable.

Fri Feb  2 18:19:20 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	Sync with savannah gawk cvsps 51.

Thu Feb  1 14:43:10 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	Sync with savannah gawk cvsps 50.

Thu Feb  1 14:29:18 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	Sync with savannah gawk cvsps 49.
	* ChangeLog: Add comments.
	* Makefile.am: No changes, patch was already in xgawk.
	* builtin.c (format_tree): Patch already in xgawk, but Arnold
	added some comments, and changed the PREPEND macro definition
	to require a semi-colon.  So builtin.c now matches savannah
	except for the 64-bit integer patch.
	* dfa.c: Accept patch, our version is the same as Savannah's.
	* node.c (format_val): Patch already in xgawk except for a change
	in a comment.  Now node.c is identical to Savannah.

Tue Jan 30 19:44:05 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: Change test for getaddrinfo to find the function
	in -lsocket if it is not found in -lc.  This allows the code
	to build on Solaris.  I'm not sure whether other platforms may
	have getaddrinfo in some other library...

Sun Jan 28 22:40:53 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: (valgrind) Older valgrind uses a different log file
	naming convention, so remove log.* to cover all cases.

Sat Jan 27 18:03:50 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am (valgrind): Remove old log files first, and make
	valgrind-scan afterwards to show the errors.
	(valgrind-scan): New target to cd into test and scan valgrind logs.

Fri Jan 26 21:18:14 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	Sync with savannah gawk cvsps 48.

Fri Jan 26 21:15:26 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	Sync with savannah gawk cvsps 47.

Fri Jan 26 21:12:20 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	Sync with savannah gawk cvsps 46.

Fri Jan 26 20:29:30 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	Now should in sync with savannah gawk-stable through cvsps 45, except
	for awklib/Makefile.am (our version builds the 'eg' tree in the
	build directory instead of inside $(srcdir)), and po/ja.po (since
	somebody needs to merge the changes made in gawk with the
	xgawk changes by Hirofumi Saito -- only 6 of the 23 patch hunks
	between gawk 3.1.5 and patchset 45 were accepted).  Also, please
	note that awkgram.y now matches regular gawk in having support for the 
	AWKREADFUNC environment variable to enable the use of
	VMS-style record-oriented I/O, but this will not work properly
	if nested source files ('@include') are being used, since the
	FILE pointer is kept in a static variable.  To support this
	feature properly, we would need to add the FILE pointer to struct
	input_state.

Fri Jan 12 18:08:39 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* node.c (str2wstr): Call free_wstr instead of freeing the pointer
	directly.  This way is more inefficient, but it matches Arnold's
	code, so I'm doing it to reduce the code divergence (and to make
	future patches easier to port).

Fri Jan 12 16:02:14 UTC 2007 Ralf Wildenhues <Ralf.Wildenhues@gmx.de>

	* field.c (set_FIELDWIDTHS): Avoid writing one past the end of
	the array.
	* node.c (r_force_number): Avoid reading uninitialized variable.

Fri Jan 12 15:56:43 UTC 2007 Dmitry V. Levin <ldv@altlinux.org>

	* builtin.c (do_match): In addition to "gawk_mb_cur_max > 1" check,
	check for positive string length.

Fri Jan 12 15:53:49 UTC 2007 Sven Wegener <swegener@gentoo.org>

	* builtin.c (do_match): Move freeing of wc_indices to outside if.

Fri Jan 12 15:43:30 UTC 2007 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h, builtin.c, eval.c, node.c: Rename release_wstr() to
	free_wstr() to harmonize with Arnold's choice of function name,
	thereby making it easier to track his code and apply patches.

Tue Sep  5 23:11:35 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awkgram.y (get_src_buf) For CMDLINE program source, be sure to
	reset source & sourceline properly so that error messages will
	have the correct location.

Tue Jul 18 17:26:51 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Declare new function release_wstr and wrapper macro
	RELEASE_WSTR that is a no-op if MBS_SUPPORT is not defined.
	* node.c (format_val): Use new RELEASE_WSTR macro.
	(unref): Fix bug where wstptr for field variables was not being freed.
	And use the new RELEASE_WSTR macro to replace some inline code.
	(release_wstr): New function to free wstptr and check consistency.
	(str2wstr): Do not free wstptr if the WSTRCUR flag is not set,
	since I think that wstptr is not defined unless WSTRCUR is set.
	* builtin.c (sub_common): Must release t's wstr, since the
	string value has changed.
	* eval.c (r_tree_eval): In case Node_assign_concat, must
	release l->wstptr, not r->wstptr, since r will be freed a couple
	of lines below anyway, but l->stptr has changed, thereby
	invalidating l->wstptr.

Thu Jul 13 15:54:25 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am (EXTRA_DIST): Add update-autotools to the distro.

Mon Jul  3 00:27:59 2006  Arnold D. Robbins  <arnold@skeeve.com>

	Apply Arnold's io.c jumbo patch vs. 3.1.5.  This one seems to work.

	Repair internal names like /dev/user, /dev/pid, as well as /dev/fd/N,
	which have been broken for a long time but noone noticed.

	* io.c (INTERNAL_HANDLE): New constant for use by `iop_alloc'
	when allocating an internal IOBUF.
	(pidopen, useropen): Use it.
	(iop_alloc): Add check for it and just return iop.
	(is_internal): new macro to check for internal file like `/dev/user'.
	(spec_setup): Reduce to two parameters, allocate logic is always true.
	Add IOP_NO_FREE to flag.
	(pidopen, useropen): Return `IOBUF *' instead of int. Fix
	logic to test if `iop' parameter is NULL and if so to allocate it.
	(specfdopen,): Return `IOBUF *' instead of int. Fix
	logic to test if `iop' parameter is NULL and if so to allocate it.
	Don't set IOP_NO_FREE in flag.
	(iop_open): Remove `IOBUF iob' field from `struct internal' and its use
	and the use of `spec_setup' from the code here. Change the check in the
	call to the open function to look for NULL.
	(get_a_record): Use `is_internal' in initial check for filling the
	buffer to not try to call `read' on internal files. If true, set
	the IOP_AT_EOF in the flag and return EOF.

Tue Jul  4 22:43:05 2006  Arnold D. Robbins  <arnold@skeeve.com>

	* eval.c (interpret): Node_assign_concat case: Turn off NUMBER and
	NUMCUR flags in result.  Sheesh. Thanks to <Heiner.Marxen@DrB.Insel.DE>
	for finding the problem.

Mon Jul  3 20:19:52 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* io.c: Revert previous patch.  Jürgen pointed out that it breaks
	"make check".  Waiting for better patch.

Sun Jun 18 22:27:25 2006  Arnold D. Robbins  <arnold@skeeve.com>

	Repair internal names like /dev/user, /dev/pid, as well as /dev/fd/N,
	which have been broken for a long time but noone noticed.

	* io.c (is_internal): new macro to check for internal file like `/dev/user'.
	(spec_setup): Reduce to two parameters, allocate logic is always true.
	Add IOP_NO_FREE to flag.
	(pidopen, useropen): Return `IOBUF *' instead of int. Fix
	logic to test if `iop' parameter is NULL and if so to allocate it.
	(specfdopen,): Return `IOBUF *' instead of int. Fix
	logic to test if `iop' parameter is NULL and if so to allocate it.
	Don't set IOP_NO_FREE in flag.
	(iop_open): Remove `IOBUF iob' field from `struct internal' and its use
	and the use of `spec_setup' from the code here. Change the check in the
	call to the open function to look for NULL.
	(get_a_record): Use `is_internal' in initial check for filling the
	buffer to not try to call `read' on internal files. If true, set
	the IOP_AT_EOF in the flag and return EOF.

Mon Jun 19 15:43:41 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* io.c: Revert previous patch.  I had failed to notice that Arnold
	sent a subsequent email with a better patch.  This reverted patch
	fixed only one case, but still left many bugs.

Mon Jun 19 14:51:30 UTC 2006 Aharon Robbins <arnold@skeeve.com>

	* io.c: Fix /dev/fd/n processing bug reported by John H. DuBois III
	<spcecdt@armory.com>.
	(spec_setup): Set IOP_NO_FREE flag.
	(specfdopen): Do not set the IOP_NO_FREE flag.

Thu Mar 30 13:05:40 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* main.c (copyleft): Change URL for sourceforge from https to http.

Mon Mar 20 21:48:36 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* main.c (load_environ): Fix bug inserting "AWKLIBPATH" into the
	ENVIRON array: the 2nd arg to tmp_string should be 10, not 7.

Mon Mar 20 16:49:49 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: Change XGAWKBUILD from beta-2006-04-01 to
	beta.20060401 so that it can be used in the RPM release string.
	Add packaging/Makefile and packaging/xgawk.spec to AC_CONFIG_FILES.
	* Makefile.am: Add packaging to SUBDIRS.

Sat Mar 18 21:00:27 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* packaging: Created a new directory for platform-specific packing
	info, e.g. RPM .spec files.

Fri Mar 17 23:23:33 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: Enable the "switch" statement by default.

Fri Mar 17 23:07:24 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: In checking for MPFR support, change the AC_CHECK_LIB
	statements to avoid linking the main gawk binary against -lgmp.

Fri Mar 17 20:05:04 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: Change AC_INIT -- the PACKAGE name is now xgawk,
	not gawk, and the PACKAGE_STRING is now "Extensible GNU Awk".
	Define a program_transform_name sed program to install xgawk and
	pxgawk instead of the default gawk and pgawk binaries.
	Remove CONFDATE, and change XGAWKBUILD not to contain any embedded
	spaces (so it is suitable for use in naming the distribution tar file).
	Add AC_SUBST macros to define pkglibexecdir and pkgextensiondir.
	Add a new --enable-gawk option that will cause awk, gawk, and igawk
	to be installed in addition to xgawk and pxgawk.
	* Makefile.am: Remove leading "x" from distdir and use XGAWKBUILD
	instead of CONFDATE.
	Remove definitions of pkgdatadir, libexecdir, and extensiondir
	(these are supplied by automake or not needed).  Change DEFLIBPATH
	to use pkgextensiondir (from configure.ac) instead of extensiondir.
	If INSTALL_GAWK is true (i.e. configure was invoked with --enable-gawk),
	then install symbolic links for awk, gawk, and igawk.
	* version.in: Remove "Extensible", since it is now included in
	@PACKAGE_STRING@.

Wed Mar 15 16:44:06 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* missing_d/snprintf.c: Fix white space and pointer comparisons to
	match gawk coding style, as per Arnold's request.

Tue Mar 14 17:07:59 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* missing_d/snprintf.c: Implement snprintf replacement for platforms
	that need it.
	* configure.ac: Test for functions mkstemp and tmpfile, since they
	may be used in the snprintf replacement code.
	* awk.h: If HAVE_SNPRINTF is not defined, then declare the replacement
	functions gawk_snprintf and gawk_vsnprintf, and define snprintf and
	vsnprintf to call the replacement functions.
	* replace.c: If HAVE_SNPRINTF is not defined, then include the
	replacement code in missing_d/snprintf.c.

Sun Mar 12 14:08:40 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* configure.ac, version.in, main.c: New variable XGAWKBUILD
	contains name of current build of xgawk. This name is printed
	upon "gawk --version". Another string containing instructions
	for reporting bugs to the xmlgawk-users mailing list is printed
	upon "gawk --help". Recognition of GMP and MPFR more robust and
	precise now. Superfluous warnings don't appear anymore.

Wed Mar  8 23:37:06 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* builtin.c (format_tree): As per Arnold's suggestion, use size_t
	instead of u_int to avoid possible portability problems.

Tue Mar  7 17:44:10 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* configure.ac: If libgmp is not found, print only a warning.

Mon Mar  6 22:18:38 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	Patch for large integer formatting problems related to IEEE conversion
	issues between integers and floating point.  Arnold has not accepted
	this patch, but I think he agrees that these bugs must be fixed.
	* node.c (format_val): Test whether a numeric value is integral
	simply by converting it to long and then back again, and checking
	if the value matches.  That's more robust than trying to test
	whether the floating-point value is representable as a long.
	* builtin.c (format_tree): Fix buffer overflow bug, off-by-one errors
	in checking snprintf return codes, and use "%.0f" to implement "%d"
	formatting.  For octal or hex formatting, test whether the value
	is integral by trying to convert back to floating point and seeing
	if the value matches.  This is more robust than trying to test
	whether the floating-point value is representable as an integer.

Mon Mar  6 19:16:50 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* regcomp.c, regexec.c: Koichi Kimura posted a patch at
	http://sources.redhat.com/bugzilla/show_bug.cgi?id=1149
	and Arnold Robbins confirmed that he merges the patch
	into his tree on 2006-02-20 in gnu.utils.bug. So do we.

Mon Mar  6 18:58:58 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* configure.ac: After a long discussion with Patrick Pelissier
	and Vincent Lefèvre (from the MPFR team), I changed automatic
	detection of MPFR. It is better to detect the function
	mpfr_free_str and not mpfr_set_nanflag. But mpfr_free_str is
	difficult to detect on some systems because mpfr_free_str
	depends on GMP. The solution is to force linking of GMP during
	autodetection.

Thu Feb 23 21:05:45 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* io.c (get_a_record): Eliminate duplicate (no-op) code that was
	introduced in the 3.1.5 upgrade.

Fr Feb 17 17:06:25 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* AUTHORS: Explained the relation between the XMLgawk
	project at SourceForge and Arnold Robbins' GNU Awk.

Wed Feb 15 22:05:21 UTC 2006 Arnold D. Robbins  <arnold@skeeve.com>

	* eval.c (r_tree_eval): Fix bug in wide characters concatenation
	(case Node_assign_concat).
	http://lists.gnu.org/archive/html/bug-gnu-utils/2006-02/msg00037.html
	Reported by Karel Zak <kzak@redhat.com>.

Thu Feb  9 17:36:30 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* eval.c (update_ERRNO_saved): Void functions shouldnt return
	anything. AIX's cc didnt like this.

Wed Feb  8 17:35:40 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* configure.ac: Changed recognition of MPFR so that GMP
	will not annoy us any longer.

Mon Feb  6 22:38:47 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* configure.ac: When MPFR is not found to work, build is not
	terminated but goes on without building MPFR.

Sun Feb  5 14:05:57 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* configure.ac: Cleaned up detection of presence of MPFR lib.
	Building MPFR extension is now confined to MPFR version 2.2 or later.
	Building with other versions (especially the one that comes wit
	GMP) will result in termination and upgrade instructions.

Sun Jan 29 21:01:06 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* configure.ac: Inserted new option "--with-mpfr" for MPFR extension.

Wed Jan 18 21:57:56 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* configure.ac: Inserted new MPFR extension.

Thu Jan 12 22:11:28 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Change test for whether to use gawk_strtod to match the
	test in replace.c (i.e. should use gawk_strtod #ifndef HAVE_STRTOD).

Fri Sep 23 16:05:13 2005  Arnold D. Robbins  <arnold@skeeve.com>

	* awkgram.y (get_src_buf): Make the test for expanding the buffer
	smarter, so that it doesn't grow unnecessarily.

	Thanks to Galen Tackett (tackett_galen@bah.com) for reporting
	the problem and to Anders Wallin and Pat Rankin for help
	tracing and reproducing the problem and testing the fix.

Fri Aug 12 13:10:33 2005  Arnold D. Robbins  <arnold@skeeve.com>

	* io.c (iop_alloc): Only free `iop' if it was malloc'ed in
	the first place.

Sat Sep  3 16:03:25 EDT 2005  Kito Danya Dietrich  <kito@gentoo.org>

	* hard-locale.h (hard_locale): Declare xmalloc in global scope rather
	than function scope which gcc-4.x rejects.

Fri Oct  7 13:23:29 2005  Arnold D. Robbins  <arnold@skeeve.com>

	* field.c (set_FIELDWIDTHS): Fix off-by-one error in assignment
	of sentinel value at end of FIELDWIDTHS array.

Tue Jan 10 19:51:26 UTC 2006 Paul Eggert <eggert@CS.UCLA.EDU>

	* node.c (str2wstr): Must handle 0 return code from mbrtowc properly.

Mon Jan  9 23:37:28 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* io.c (path_find): Fix stupid bugs in code that is used only
	when a file is not found in AWKPATH and it falls back to trying
	the current directory.

Mon Jan  9 14:06:53 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* config.guess, config.sub: Remove files that are actually built
	by libtool.
	* .cvsignore: Add config.guess and config.sub.

Fri Jan  6 19:24:35 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* .cvsignore: Add aclocal.m4.

Fri Jan  6 18:55:45 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* aclocal.m4: Remove file that is rebuilt by the aclocal command.

Fri Jan  6 18:37:55 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* po/*.gmo: Remove files that are rebuilt by the Makefile using msgfmt.

Tue Jan  3 22:12:07 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* po/.cvsignore: Should ignore *.gmo, since they are generated by
	the Makefile.

Tue Jan  3 22:08:43 UTC 2006 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am (awkgram.c): When running bisonfix.awk, use $(AWK)
	instead of awk to improve platform portability (Solaris 8 awk,
	for example, cannot run bisonfix.awk).

Mon Jan  2 12:53:34 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* io.c (iop_close): Took over Arnolds version in lines around 397.

Sun Jan  1 23:02:51 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* pc/Makefile.tst: Applied patch 2.
	* po/gawk.pot:     Applied patch 3.
	Applied patches 1 and 219 to finalize all this patching.

Sun Jan  1 22:14:00 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* test/ChangeLog: Applied patch 156.
	* test/Makefile.am, test/Maketests: Applied patches 157
	and 159. New test cases exitval2, fsspcoln, gensub2,
	gnuops3, hex, iobug1, longdbl, nondec2, rsstart1, rsstart2,
	rsstart3, wjposer1. Renamed GAWK_LOCALE to GAWKLOCALE.
	* test/Makefile.in: Ignored patch 158. File test/Makefile.in
	is not in CVS repository.
	* test/iobug1.awk, test/iobug1.ok: Applied patch 174 and
	219 (partly). New test case which causes a hanging
	interpreter with earlier versions of gawk.
	* test/nondec.awk, test/nondec.ok: Applied patches 178 and 179.
	New test case about printing of hex numbers.

Sun Jan  1 21:53:09 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* io.c: Applied patch 85. Except for these lines, which
	caused trouble, I commented them out:
        if (iop->close_func != NULL)
                (*iop->close_func)(iop);

Sun Jan  1 20:08:03 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* awk.h, awkgram.y, builtin.c: Applied patches 35, 36 and 41.
	Patch 35 is complete now. Most changes caused by multibyte
	support and deferred variable setting.
	* io.c:      Ignored patch 85 at the moment. Inserted only
	close_io from the patch. If patch 85 was applied, most XML
	regression test cases would fail. There is obviously a clash
	between the CVS repository and gawk 3.1.5. So I skipped patch
	85 and have to return to it later.
	* main.c:    Applied patch 120. New options --exec, -S and
	deferred variables (loaded only when accessed).
	* node.c:    Applied patch 132. New function isnondecimal,
	multibyte support.
	* test/badargs.ok: Applied patch 160. New option --exec appears.

Sun Jan  1 15:29:35 UTC 2006 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* exitval2.awk, exitval2.ok, gensub2.awk, gensub2.ok, gnuops3.awk,
	gnuops3.ok, hex.awk, hex.ok, rsstart2.awk, rsstart2.ok, rsstart3.ok:
	Applied patches 163, 164, 168 to 173, 189 to 191.
	All these files are needed for new test cases.

Sat Dec 31 21:35:57 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* awk.h: Applied patch 35, but with two exceptions.
	isnondecimal is not yet removed, and close_io does not yet
	have a parameter. This incompletely applied patch 35 allows
	us to go on applying other patches incrementally.
	* regcomp.c, regex_internal.c, regex_internal.h, regexec.c:
	Applied patches 150, 153, 154 and 155. Dubious struggling with
	LIBC, i18n and wide characters.

Sat Dec 31 00:26:05 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* re.c: Applied patch 149, mostly multibyte character handling.
	Change incorrect uses of STREQN to memcmp.
        Last paramater of function research is now flags.

Fri Dec 30 23:22:38 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* array.c: Applied patch 34. Postal address of FSF has changed.
	Replacement of STREQN with memcmp is obsolete now that we use
	STREQNN in functions assoc_find and do_delete.

Fri Dec 30 23:10:03 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* field.c: Applied patch 76. New function isblank.
	Made FIELDWIDTHS detect overflow and invalid strings.
	Use RE_NEED_START, RE_NO_BOL for "research".
	Change incorrect uses of STREQN to memcmp.

Fri Dec 30 22:12:04 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* eval.c: Applied patch 64. New functions calc_exp_posint,
	calc_exp, and update_ERRNO. Using new macro RE_NEED_START
	from new awk.h.
	* awk.h: Inserted new macros RE_NEED_START and RE_NO_BOL
	from patch 35, which is not yet applied.

Fri Dec 30 18:30:41 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* doc/ChangeLog:   Applied patch 52.
	* doc/Makefile.am: Applied patch 53. Per Stepan Kasal,
	removed html rules, since Automake does it for us.
	* doc/Makefile.in: Ignored patch 54. File doc/Makefile.in
	is not in CVS repository.
	* doc/ad.block:    Applied patch 55. Postal address of FSF has changed.
	* doc/awkcard.in:  Applied patch 56.
	Documented new --exec option and `length(array)'.
	* doc/gawk.1:      Applied patch 57.
	Documented new --exec option and `length(array)'.
	* doc/gawk.texi:   Applied patch 58.
	Removed references to `--with-included-gettext'.
	Documented new --exec option and `length(array)'. 
	Arnold also inserted an early version of Andrew's doc on
	function registration. I rejected this single patch and
	left our doc as it is in this place.
	* doc/gawkinet.info, doc/gawkinet.texi, doc/macros, doc/setter.outline:
	Applied patches 59 to 62.  Postal address of FSF has changed.
	* doc/texinfo.tex: Applied patch 63. Updated to version 2005-01-30.17.

Fri Dec 30 16:33:41 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* extension/zaxxon.c: Applied patch 69, which originally
	modifies file extension/dl.c, but was renamed in our source tree.
	Only postal address of FSF has changed.
	* extension/filefuncs.c: Applied patch 70. Our source tree
	already had such a patch, but the patch was different, so
	I used patch 70 ("sizeof buf" vs. "sizeof(buf) - 1").

Fri Dec 30 16:20:08 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* config.guess: Applied patch 42. Some OpenBSD platforms have
	gone, some Linux platforms are new.
	* config.rpath: Applied patch 43. Copyright change, some
	changes with Darwin and Linux platforms.
	* config.sub:   Applied patch 44. Some new platforms are
	maxq, xscale variants, crisv32, djgpp, xbox, zvmoe.
	* configh.in:   Ignored patch 45. File configh.in is not
	in CVS repository.

Thu Dec 29 20:40:46 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* awklib/ChangeLog:   Applied patch 37.
	* awklib/Makefile.am: Applied patch 38 with renaming of directories.
	Patch collision. I am not sure if my merge is good enough.
	Andreas Schwab introduced igawk into this and didnt really know
	what to do with it.
	* awklib/Makefile.in: Ignored patch 39. File awklib/Makefile.in
	is not in CVS repository.

Thu Dec 29 20:10:40 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* custom.h: Applied patch 48. Postal address of FSF has changed.
	* depcomp:  Applied patch 49. Postal address of FSF has changed.
	Update to Automake 1.9.5.

Thu Dec 29 20:03:54 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* eval_p.c, ext.c: Applied patches 65 and 66. Postal address of FSF has changed.

Thu Dec 29 19:36:54 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* extension/ChangeLog:   Applied patch 67.
	* extension/arrayparm.c: Applied patch 68. Postal address of FSF has changed.
	* extension/fork.c:      Applied patch 71. Postal address of FSF has changed.
	* extension/ordchr.c:    Applied patch 72. Postal address of FSF has changed.
	* extension/readfile.c:  Applied patch 73. Postal address of FSF has changed.
	* extension/xreadlink.c: Applied patch 74. New source file, written by Jim Meyering.
	* extension/xreadlink.h: Applied patch 75. New source file, written by Jim Meyering.

Thu Dec 29 18:54:57 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* random.c, random.h: Applied patches 147 and 148.
	Cleaning up LIBC macros and 32 bit typing.

Thu Dec 29 18:41:19 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* regex.c, regex.h: Applied patches 151 and 152.
	Cleaning up LIBC macros.

Thu Dec 29 18:00:56 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* test/clobber.awk:  Applied patch 161. Postal address of FSF has changed.
	* test/concat1.awk:  Applied patch 162. Postal address of FSF has changed.
	* test/fsspcoln.awk, test/fsspcoln.in, test/fsspcoln.ok:
	Applied patches 165 to 167 for new test case with 'FS=[ :]+'.
	* test/longdbl.awk, test/longdbl.in, test/longdbl.ok:
	Applied patches 175 to 177 for rounding problems when manipulating 64-bit ints.
	* test/nondec2.awk, test/nondec2.ok:
	Applied patches 180 to 181 for --non-decimal-data.
	* test/nulrsend.awk, test/ofmtfidl.awk:
	Applied patches 182 to 183. Postal address of FSF has changed.
	* test/reg/func2.out: Applied patch 184 for illegal function call.
	* test/regtest.sh: Applied patch 185 for replacing "cmp" with "diff".
	* test/rsstart1.awk, test/rsstart1.in, test/rsstart1.ok:
	Applied patches 186 to 188 for test case with RS = "^A".
	* test/wjposer1.awk, test/wjposer1.in, test/wjposer1.ok:
	Applied patches 192 to 194 for new test case which tests
	"Clean up for next input record".

Thu Dec 29 15:17:45 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* dfa.c, dfa.h: Applied patches 50 and 51. Postal address of FSF has changed.
	Don't use gettext if ENABLE_NLS is not defined.
	Added multibyte strings, removed copy of hard-locale.c.

Thu Dec 29 14:15:22 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* configure.ac: Applied patch 47. Postal address of FSF has changed.
	Version changed from 3.1.4 to 3.1.5. New AC_DEFUN([TYPE_SOCKLEN_T].
	Handling of version.c changed.
	* aclocal.m4: Ignored patch 33. Committed generated aclocal.m4.
	* configure:  Ignored patch 46. File configure is not in CVS repository.
	* version.in: Applied patch 205. Replaces @VERSION@ with @PACKAGE_STRING@.
	* version.c:  Ignored patch 204. File version.c is not in CVS repository.

Thu Dec 29 14:04:14 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* Makefile.am: Removed "intl" from SUBDIRS, just as
	suggested by Arnold's patch 26 (Jim Meyering), because of this:
	Makefile.am:100: `intl' should not be in SUBDIRS when AM_GNU_GETTEXT([external]) is used
	So, I also removed "intl" and problems stopped appearing.

Thu Dec 29 13:20:13 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* m4/ChangeLog, m4/arch.m4, m4/codeset.m4, m4/gettext.m4,
	m4/glibc2.m4, m4/glibc21.m4, m4/iconv.m4, m4/intdiv0.m4,
	m4/intmax.m4, m4/intmax_t.m4, m4/inttypes-pri.m4,
	m4/inttypes.m4, m4/inttypes_h.m4, m4/isc-posix.m4,
	m4/lcmessage.m4, m4/lib-ld.m4, m4/lib-link.m4, m4/lib-prefix.m4,
	m4/longdouble.m4, m4/longlong.m4, m4/nls.m4, m4/po.m4,
	m4/printf-posix.m4, m4/progtest.m4, m4/signed.m4, m4/size_max.m4,
	m4/socket.m4, m4/stdint_h.m4, m4/strtod.m4, m4/uintmax_t.m4,
	m4/ulonglong.m4, m4/wchar_t.m4, m4/wint_t.m4, m4/xsize.m4:
	Applied patches 86 to 119. Postal address of FSF has changed.
	These macros are needed for the autoconf mechanisms.
	I have taken over all patches unchanged.
	There seems to be something wrong with AC_TYPE_INTMAX_T,
	but this issue caused no trouble up to now.

Wed Dec 28 22:46:43 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* gawkmisc.c: Applied patch 77. Postal address of FSF has changed.
	* getopt.c:   Applied patch 78. Synced to GLIBC version.
	* getopt.h:   Applied patch 79. Synced to GLIBC version
	* getopt1.c:  Applied patch 80. Synced to GLIBC version
	* gettext.h:  Applied patch 82. Postal address of FSF has changed.
	* install-sh: Applied patch 84. Update to Automake 1.9.5.

Wed Dec 28 22:00:37 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* getopt_int.h:  New file from patch 81 needed by Makefile.am.
	* hard-locale.h: New file from patch 83 needed by Makefile.am.
	* bisonfix.awk:  New file from patch 40 needed by Makefile.am.
	Replaces bisonfix.sed, which is obsolete now.
	* Makefile.am: Applied patch 26, but I decided to reject one
	change made by Jim Meyering. Jim removed the directory "intl"
	and mentioned his action in ChangeLog, but he failed to explain
	his reasoning.
	* Makefile.in: Ignored patch 27 since Makefile.in is generated
	anyway and not part of our CVS repository.
	I am pretty confident that all these patches will break some
	things on non-Unix platforms.

Wed Dec 28 19:48:56 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* profile.c, profile_p.c, protos.h:
	Applied patches 144 to 146. Postal address of FSF has changed.
	Correction in profiling of "!" operator already existed.

Wed Dec 28 19:44:34 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* posix/ChangeLog, posix/gawkmisc.c:
	Applied patch 142 and 143. Postal address of FSF has changed. 

Wed Dec 28 19:38:39 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* msg.c:
	Applied patch 131. Postal address of FSF has changed. 

Wed Dec 28 19:28:43 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* po/ChangeLog, po/LINGUAS, po/Makefile.in.in:
	Applied patches 139 zo 141. These files control the building
	of translations of messages for some additional languages. 

Tue Dec 27 21:27:00 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* po/ca.po, po/da.po, po/de.po, po/es.po, po/fr.po, po/ga.po, po/he.po, po/it.pom,
	po/ja.po, po/nl.po, po/pl.po, po/pt_BR.po, po/ro.po, po/rw.po, po/sv.po, po/tr.po, po/vi.po:
	Applied patches 4 zo 20. These are translations of messages in
	the C source code files. I simply replaced the 3.1.4 files with
	the 3.1.5 files. But this is not enough. We need translations for
	all messages which are specific to xgawk.

Tue Dec 27 18:50:29 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* mbsupport.h: Applied patch 121. Trivial textual changes and
	minor improvement of centralized i18n handling.

Tue Dec 27 18:30:02 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* ABOUT-NLS, COPYING, ChangeLog, FUTURES, INSTALL, NEWS, README:
	Applied patches 21, 22, 23, 24, 25, 28, 29.
	Trivial textual changes, explanation of translation project for
	packages, and some explanation of build mechanisms.

Tue Dec 27 18:04:58 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* missing, missing_d/COPYING.LIB, missing_d/ChangeLog, missing_d/mktime.c,
	missing_d/strerror.c, missing_d/strftime.c, missing_d/strtod.c,
	missing_d/strtoul.c, missing_d/system.c:
	Applied patches 122 to 130.
	Trivial textual changes and some improvements in autoconf mechanisms.

Tue Dec 27 17:43:23 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* README_d/README.cygwin-dynamic, README_d/README.macos, README_d/README.multibyte:
	Applied patches 30 to 32.
	Some hints for dynamic libs on cygwin, gcc 4.0 with MacOSX and
	an explanation of multibyte characters.

Tue Dec 27 16:24:24 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* pc/ChangeLog, pc/Makefile, pc/config.h, pc/dlfcn.c, pc/dlfcn.h, pc/gawkmisc.pc:
	Applied patches 133 to 138.
        These are "pc" specific trivial textual changes and some changes
	in compiler options not yet tested on their platform.

Tue Dec 27 15:13:06 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* ylwrap: Applied patch 218. Trivial textual changes,
	proper return value handling, and renaming of variable.

Tue Dec 27 14:52:16 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* unsupported/atari/ChangeLog, unsupported/atari/Makefile.awklib
	unsupported/atari/Makefile.st, unsupported/atari/config.h,
	unsupported/atari/gawkmisc.atr, unsupported/atari/redirect.h:
	Applied patches 195 to 200.
        These are "atari" specific trivial textual changes and not yet
        tested on their platform.

Tue Dec 27 14:44:11 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* unsupported/tandem/ChangeLog, unsupported/tandem/config.h,
	unsupported/tandem/tmisc.c: Applied patches 201 to 203.
	These are "tandem" specific trivial textual changes and not yet
	tested on their platform. 

Tue Dec 27 13:44:14 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* vms/ChangeLog, vms/descrip.mms, vms/gawkmisc.vms, vms/redirect.h,
	 vms/vms-conf.h, vms/vms_args.c, vms/vms_fwrite.c, vms/vms_gawk.c,
	 vms/vms_misc.c, vms/vms_popen.c, vms/vmsbuild.com, vms/vmstest.com:
	Applied patches 206 to 217. These are VMS specific and not yet tested on VMS.

Tue Dec 27 10:46:43 UTC 2005 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* XMLChangeLog: Made a plan for upgrade to gawk 3.1.5.
	Arnold's official upgrade patch from 3.1.4 to 3.1.5 can
	be downloaded at ftp://ftp.gnu.org/gnu/gawk/gawk-3.1.4-3.1.5.diff.gz.
	I have split it up into 219 individual patches.
	When all these patches have been applied, I will release a
	distribution file and change the project status to "beta".

	The idea is that I apply groups of patches and commit the
	changes only when the result is a source tree that can be
	properly built. In the beginning, I expect to see much progress
	in terms of applied patch numbers. In the end, I expext to see
	about 20 patches that are extremely difficult or impossible to
	apply. I guess I will need some help then. Here is the complete
	list of patches (numbering according to original sequence in
	Arnold's cumulative patch). The first column contains the number
	of the patch (I will refer to this number when committing the
	patch). The second column contains the line number of the patch
	in Arnold's original cumulative patch. The third column contains
	the very first line of the patch, usually referencing the name
	of the file to be changed.

	p# l#  1st line
	 1 10 # First, slight rearranging
	 2 12 echo - 'pc/Makefile.tst'
	 3 1496 echo - 'gawk.pot'
	 4 3289 echo - 'ca.po'
	 5 5267 echo - 'da.po'
	 6 7221 echo - 'de.po'
	 7 9200 echo - 'es.po'
	 8 11190 echo - 'fr.po'
	 9 13165 echo - 'ga.po'
	 10 15096 echo - 'he.po'
	 11 17042 echo - 'it.po'
	 12 18901 echo - 'ja.po'
	 13 20767 echo - 'nl.po'
	 14 22626 echo - 'pl.po'
	 15 24595 echo - 'pt_BR.po'
	 16 26480 echo - 'ro.po'
	 17 28442 echo - 'rw.po'
	 18 30440 echo - 'sv.po'
	 19 32399 echo - 'tr.po'
	 20 34349 echo - 'vi.po'
	 21 36373 diff -urN gawk-3.1.4/ABOUT-NLS gawk-3.1.5/ABOUT-NLS
	 22 37833 diff -urN gawk-3.1.4/COPYING gawk-3.1.5/COPYING
	 23 37854 diff -urN gawk-3.1.4/ChangeLog gawk-3.1.5/ChangeLog
	 24 38666 diff -urN gawk-3.1.4/FUTURES gawk-3.1.5/FUTURES
	 25 38678 diff -urN gawk-3.1.4/INSTALL gawk-3.1.5/INSTALL
	 26 38820 diff -urN gawk-3.1.4/Makefile.am gawk-3.1.5/Makefile.am
	 27 38927 diff -urN gawk-3.1.4/Makefile.in gawk-3.1.5/Makefile.in
	 28 39422 diff -urN gawk-3.1.4/NEWS gawk-3.1.5/NEWS
	 29 39496 diff -urN gawk-3.1.4/README gawk-3.1.5/README
	 30 39516 diff -urN gawk-3.1.4/README_d/README.cygwin-dynamic gawk-3.1.5/README_d/README.cygwin-dynamic
	 31 39608 diff -urN gawk-3.1.4/README_d/README.macos gawk-3.1.5/README_d/README.macos
	 32 39629 diff -urN gawk-3.1.4/README_d/README.multibyte gawk-3.1.5/README_d/README.multibyte
	 33 39643 diff -urN gawk-3.1.4/aclocal.m4 gawk-3.1.5/aclocal.m4
	 34 40438 diff -urN gawk-3.1.4/array.c gawk-3.1.5/array.c
	 35 40477 diff -urN gawk-3.1.4/awk.h gawk-3.1.5/awk.h
	 36 40686 diff -urN gawk-3.1.4/awkgram.y gawk-3.1.5/awkgram.y
	 37 41053 diff -urN gawk-3.1.4/awklib/ChangeLog gawk-3.1.5/awklib/ChangeLog
	 38 41097 diff -urN gawk-3.1.4/awklib/Makefile.am gawk-3.1.5/awklib/Makefile.am
	 39 41170 diff -urN gawk-3.1.4/awklib/Makefile.in gawk-3.1.5/awklib/Makefile.in
	 40 41521 diff -urN gawk-3.1.4/bisonfix.awk gawk-3.1.5/bisonfix.awk
	 41 41559 diff -urN gawk-3.1.4/builtin.c gawk-3.1.5/builtin.c
	 42 42385 diff -urN gawk-3.1.4/config.guess gawk-3.1.5/config.guess
	 43 42534 diff -urN gawk-3.1.4/config.rpath gawk-3.1.5/config.rpath
	 44 42729 diff -urN gawk-3.1.4/config.sub gawk-3.1.5/config.sub
	 45 42844 diff -urN gawk-3.1.4/configh.in gawk-3.1.5/configh.in
	 46 43207 diff -urN gawk-3.1.4/configure gawk-3.1.5/configure
	 47 52882 diff -urN gawk-3.1.4/configure.ac gawk-3.1.5/configure.ac
	 48 53090 diff -urN gawk-3.1.4/custom.h gawk-3.1.5/custom.h
	 49 53102 diff -urN gawk-3.1.4/depcomp gawk-3.1.5/depcomp
	 50 53231 diff -urN gawk-3.1.4/dfa.c gawk-3.1.5/dfa.c
	 51 53895 diff -urN gawk-3.1.4/dfa.h gawk-3.1.5/dfa.h
	 52 53928 diff -urN gawk-3.1.4/doc/ChangeLog gawk-3.1.5/doc/ChangeLog
	 53 53970 diff -urN gawk-3.1.4/doc/Makefile.am gawk-3.1.5/doc/Makefile.am
	 54 54005 diff -urN gawk-3.1.4/doc/Makefile.in gawk-3.1.5/doc/Makefile.in
	 55 54264 diff -urN gawk-3.1.4/doc/ad.block gawk-3.1.5/doc/ad.block
	 56 54278 diff -urN gawk-3.1.4/doc/awkcard.in gawk-3.1.5/doc/awkcard.in
	 57 54337 diff -urN gawk-3.1.4/doc/gawk.1 gawk-3.1.5/doc/gawk.1
	 58 54437 diff -urN gawk-3.1.4/doc/gawk.texi gawk-3.1.5/doc/gawk.texi
	 59 54885 diff -urN gawk-3.1.4/doc/gawkinet.info gawk-3.1.5/doc/gawkinet.info
	 60 54905 diff -urN gawk-3.1.4/doc/gawkinet.texi gawk-3.1.5/doc/gawkinet.texi
	 61 54928 diff -urN gawk-3.1.4/doc/macros gawk-3.1.5/doc/macros
	 62 54940 diff -urN gawk-3.1.4/doc/setter.outline gawk-3.1.5/doc/setter.outline
	 63 54952 diff -urN gawk-3.1.4/doc/texinfo.tex gawk-3.1.5/doc/texinfo.tex
	 64 55839 diff -urN gawk-3.1.4/eval.c gawk-3.1.5/eval.c
	 65 56122 diff -urN gawk-3.1.4/eval_p.c gawk-3.1.5/eval_p.c
	 66 56134 diff -urN gawk-3.1.4/ext.c gawk-3.1.5/ext.c
	 67 56164 diff -urN gawk-3.1.4/extension/ChangeLog gawk-3.1.5/extension/ChangeLog
	 68 56181 diff -urN gawk-3.1.4/extension/arrayparm.c gawk-3.1.5/extension/arrayparm.c
	 69 56193 diff -urN gawk-3.1.4/extension/dl.c gawk-3.1.5/extension/dl.c
	 70 56205 diff -urN gawk-3.1.4/extension/filefuncs.c gawk-3.1.5/extension/filefuncs.c
	 71 56251 diff -urN gawk-3.1.4/extension/fork.c gawk-3.1.5/extension/fork.c
	 72 56263 diff -urN gawk-3.1.4/extension/ordchr.c gawk-3.1.5/extension/ordchr.c
	 73 56275 diff -urN gawk-3.1.4/extension/readfile.c gawk-3.1.5/extension/readfile.c
	 74 56287 diff -urN gawk-3.1.4/extension/xreadlink.c gawk-3.1.5/extension/xreadlink.c
	 75 56384 diff -urN gawk-3.1.4/extension/xreadlink.h gawk-3.1.5/extension/xreadlink.h
	 76 56411 diff -urN gawk-3.1.4/field.c gawk-3.1.5/field.c
	 77 56513 diff -urN gawk-3.1.4/gawkmisc.c gawk-3.1.5/gawkmisc.c
	 78 56525 diff -urN gawk-3.1.4/getopt.c gawk-3.1.5/getopt.c
	 79 57541 diff -urN gawk-3.1.4/getopt.h gawk-3.1.5/getopt.h
	 80 57633 diff -urN gawk-3.1.4/getopt1.c gawk-3.1.5/getopt1.c
	 81 57739 diff -urN gawk-3.1.4/getopt_int.h gawk-3.1.5/getopt_int.h
	 82 57873 diff -urN gawk-3.1.4/gettext.h gawk-3.1.5/gettext.h
	 83 57904 diff -urN gawk-3.1.4/hard-locale.h gawk-3.1.5/hard-locale.h
	 84 57972 diff -urN gawk-3.1.4/install-sh gawk-3.1.5/install-sh
	 85 58211 diff -urN gawk-3.1.4/io.c gawk-3.1.5/io.c
	 86 58614 diff -urN gawk-3.1.4/m4/ChangeLog gawk-3.1.5/m4/ChangeLog
	 87 58639 diff -urN gawk-3.1.4/m4/arch.m4 gawk-3.1.5/m4/arch.m4
	 88 58651 diff -urN gawk-3.1.4/m4/codeset.m4 gawk-3.1.5/m4/codeset.m4
	 89 58668 diff -urN gawk-3.1.4/m4/gettext.m4 gawk-3.1.5/m4/gettext.m4
	 90 58874 diff -urN gawk-3.1.4/m4/glibc2.m4 gawk-3.1.5/m4/glibc2.m4
	 91 58908 diff -urN gawk-3.1.4/m4/glibc21.m4 gawk-3.1.5/m4/glibc21.m4
	 92 58933 diff -urN gawk-3.1.4/m4/iconv.m4 gawk-3.1.5/m4/iconv.m4
	 93 58950 diff -urN gawk-3.1.4/m4/intdiv0.m4 gawk-3.1.5/m4/intdiv0.m4
	 94 58967 diff -urN gawk-3.1.4/m4/intmax.m4 gawk-3.1.5/m4/intmax.m4
	 95 59001 diff -urN gawk-3.1.4/m4/intmax_t.m4 gawk-3.1.5/m4/intmax_t.m4
	 96 59036 diff -urN gawk-3.1.4/m4/inttypes-pri.m4 gawk-3.1.5/m4/inttypes-pri.m4
	 97 59053 diff -urN gawk-3.1.4/m4/inttypes.m4 gawk-3.1.5/m4/inttypes.m4
	 98 59070 diff -urN gawk-3.1.4/m4/inttypes_h.m4 gawk-3.1.5/m4/inttypes_h.m4
	 99 59110 diff -urN gawk-3.1.4/m4/isc-posix.m4 gawk-3.1.5/m4/isc-posix.m4
	 100 59127 diff -urN gawk-3.1.4/m4/lcmessage.m4 gawk-3.1.5/m4/lcmessage.m4
	 101 59163 diff -urN gawk-3.1.4/m4/lib-ld.m4 gawk-3.1.5/m4/lib-ld.m4
	 102 59180 diff -urN gawk-3.1.4/m4/lib-link.m4 gawk-3.1.5/m4/lib-link.m4
	 103 59231 diff -urN gawk-3.1.4/m4/lib-prefix.m4 gawk-3.1.5/m4/lib-prefix.m4
	 104 59259 diff -urN gawk-3.1.4/m4/longdouble.m4 gawk-3.1.5/m4/longdouble.m4
	 105 59276 diff -urN gawk-3.1.4/m4/longlong.m4 gawk-3.1.5/m4/longlong.m4
	 106 59302 diff -urN gawk-3.1.4/m4/nls.m4 gawk-3.1.5/m4/nls.m4
	 107 59339 diff -urN gawk-3.1.4/m4/po.m4 gawk-3.1.5/m4/po.m4
	 108 59449 diff -urN gawk-3.1.4/m4/printf-posix.m4 gawk-3.1.5/m4/printf-posix.m4
	 109 59466 diff -urN gawk-3.1.4/m4/progtest.m4 gawk-3.1.5/m4/progtest.m4
	 110 59502 diff -urN gawk-3.1.4/m4/signed.m4 gawk-3.1.5/m4/signed.m4
	 111 59519 diff -urN gawk-3.1.4/m4/size_max.m4 gawk-3.1.5/m4/size_max.m4
	 112 59536 diff -urN gawk-3.1.4/m4/socket.m4 gawk-3.1.5/m4/socket.m4
	 113 59548 diff -urN gawk-3.1.4/m4/stdint_h.m4 gawk-3.1.5/m4/stdint_h.m4
	 114 59588 diff -urN gawk-3.1.4/m4/strtod.m4 gawk-3.1.5/m4/strtod.m4
	 115 59600 diff -urN gawk-3.1.4/m4/uintmax_t.m4 gawk-3.1.5/m4/uintmax_t.m4
	 116 59637 diff -urN gawk-3.1.4/m4/ulonglong.m4 gawk-3.1.5/m4/ulonglong.m4
	 117 59663 diff -urN gawk-3.1.4/m4/wchar_t.m4 gawk-3.1.5/m4/wchar_t.m4
	 118 59680 diff -urN gawk-3.1.4/m4/wint_t.m4 gawk-3.1.5/m4/wint_t.m4
	 119 59697 diff -urN gawk-3.1.4/m4/xsize.m4 gawk-3.1.5/m4/xsize.m4
	 120 59721 diff -urN gawk-3.1.4/main.c gawk-3.1.5/main.c
	 121 59987 diff -urN gawk-3.1.4/mbsupport.h gawk-3.1.5/mbsupport.h
	 122 60025 diff -urN gawk-3.1.4/missing gawk-3.1.5/missing
	 123 60219 diff -urN gawk-3.1.4/missing_d/COPYING.LIB gawk-3.1.5/missing_d/COPYING.LIB
	 124 60242 diff -urN gawk-3.1.4/missing_d/ChangeLog gawk-3.1.5/missing_d/ChangeLog
	 125 60259 diff -urN gawk-3.1.4/missing_d/mktime.c gawk-3.1.5/missing_d/mktime.c
	 126 60273 diff -urN gawk-3.1.4/missing_d/strerror.c gawk-3.1.5/missing_d/strerror.c
	 127 60285 diff -urN gawk-3.1.4/missing_d/strftime.c gawk-3.1.5/missing_d/strftime.c
	 128 60299 diff -urN gawk-3.1.4/missing_d/strtod.c gawk-3.1.5/missing_d/strtod.c
	 129 60311 diff -urN gawk-3.1.4/missing_d/strtoul.c gawk-3.1.5/missing_d/strtoul.c
	 130 60323 diff -urN gawk-3.1.4/missing_d/system.c gawk-3.1.5/missing_d/system.c
	 131 60335 diff -urN gawk-3.1.4/msg.c gawk-3.1.5/msg.c
	 132 60347 diff -urN gawk-3.1.4/node.c gawk-3.1.5/node.c
	 133 60737 diff -urN gawk-3.1.4/pc/ChangeLog gawk-3.1.5/pc/ChangeLog
	 134 60773 diff -urN gawk-3.1.4/pc/Makefile gawk-3.1.5/pc/Makefile
	 135 60785 diff -urN gawk-3.1.4/pc/config.h gawk-3.1.5/pc/config.h
	 136 60859 diff -urN gawk-3.1.4/pc/dlfcn.c gawk-3.1.5/pc/dlfcn.c
	 137 60871 diff -urN gawk-3.1.4/pc/dlfcn.h gawk-3.1.5/pc/dlfcn.h
	 138 60883 diff -urN gawk-3.1.4/pc/gawkmisc.pc gawk-3.1.5/pc/gawkmisc.pc
	 139 60895 diff -urN gawk-3.1.4/po/ChangeLog gawk-3.1.5/po/ChangeLog
	 140 60915 diff -urN gawk-3.1.4/po/LINGUAS gawk-3.1.5/po/LINGUAS
	 141 60926 diff -urN gawk-3.1.4/po/Makefile.in.in gawk-3.1.5/po/Makefile.in.in
	 142 61044 diff -urN gawk-3.1.4/posix/ChangeLog gawk-3.1.5/posix/ChangeLog
	 143 61055 diff -urN gawk-3.1.4/posix/gawkmisc.c gawk-3.1.5/posix/gawkmisc.c
	 144 61067 diff -urN gawk-3.1.4/profile.c gawk-3.1.5/profile.c
	 145 61096 diff -urN gawk-3.1.4/profile_p.c gawk-3.1.5/profile_p.c
	 146 61108 diff -urN gawk-3.1.4/protos.h gawk-3.1.5/protos.h
	 147 61120 diff -urN gawk-3.1.4/random.c gawk-3.1.5/random.c
	 148 61458 diff -urN gawk-3.1.4/random.h gawk-3.1.5/random.h
	 149 61502 diff -urN gawk-3.1.4/re.c gawk-3.1.5/re.c
	 150 61664 diff -urN gawk-3.1.4/regcomp.c gawk-3.1.5/regcomp.c
	 151 63518 diff -urN gawk-3.1.4/regex.c gawk-3.1.5/regex.c
	 152 63587 diff -urN gawk-3.1.4/regex.h gawk-3.1.5/regex.h
	 153 63648 diff -urN gawk-3.1.4/regex_internal.c gawk-3.1.5/regex_internal.c
	 154 64124 diff -urN gawk-3.1.4/regex_internal.h gawk-3.1.5/regex_internal.h
	 155 64473 diff -urN gawk-3.1.4/regexec.c gawk-3.1.5/regexec.c
	 156 66911 diff -urN gawk-3.1.4/test/ChangeLog gawk-3.1.5/test/ChangeLog
	 157 66990 diff -urN gawk-3.1.4/test/Makefile.am gawk-3.1.5/test/Makefile.am
	 158 67216 diff -urN gawk-3.1.4/test/Makefile.in gawk-3.1.5/test/Makefile.in
	 159 67634 diff -urN gawk-3.1.4/test/Maketests gawk-3.1.5/test/Maketests
	 160 67707 diff -urN gawk-3.1.4/test/badargs.ok gawk-3.1.5/test/badargs.ok
	 161 67718 diff -urN gawk-3.1.4/test/clobber.awk gawk-3.1.5/test/clobber.awk
	 162 67730 diff -urN gawk-3.1.4/test/concat1.awk gawk-3.1.5/test/concat1.awk
	 163 67742 diff -urN gawk-3.1.4/test/exitval2.awk gawk-3.1.5/test/exitval2.awk
	 164 67749 diff -urN gawk-3.1.4/test/exitval2.ok gawk-3.1.5/test/exitval2.ok
	 165 67754 diff -urN gawk-3.1.4/test/fsspcoln.awk gawk-3.1.5/test/fsspcoln.awk
	 166 67799 diff -urN gawk-3.1.4/test/fsspcoln.in gawk-3.1.5/test/fsspcoln.in
	 167 67804 diff -urN gawk-3.1.4/test/fsspcoln.ok gawk-3.1.5/test/fsspcoln.ok
	 168 67809 diff -urN gawk-3.1.4/test/gensub2.awk gawk-3.1.5/test/gensub2.awk
	 169 67818 diff -urN gawk-3.1.4/test/gensub2.ok gawk-3.1.5/test/gensub2.ok
	 170 67825 diff -urN gawk-3.1.4/test/gnuops3.awk gawk-3.1.5/test/gnuops3.awk
	 171 67843 diff -urN gawk-3.1.4/test/gnuops3.ok gawk-3.1.5/test/gnuops3.ok
	 172 67852 diff -urN gawk-3.1.4/test/hex.awk gawk-3.1.5/test/hex.awk
	 173 67878 diff -urN gawk-3.1.4/test/hex.ok gawk-3.1.5/test/hex.ok
	 174 67888 diff -urN gawk-3.1.4/test/iobug1.awk gawk-3.1.5/test/iobug1.awk
	 175 67945 diff -urN gawk-3.1.4/test/longdbl.awk gawk-3.1.5/test/longdbl.awk
	 176 68108 diff -urN gawk-3.1.4/test/longdbl.in gawk-3.1.5/test/longdbl.in
	 177 68114 diff -urN gawk-3.1.4/test/longdbl.ok gawk-3.1.5/test/longdbl.ok
	 178 68120 diff -urN gawk-3.1.4/test/nondec.awk gawk-3.1.5/test/nondec.awk
	 179 68126 diff -urN gawk-3.1.4/test/nondec.ok gawk-3.1.5/test/nondec.ok
	 180 68132 diff -urN gawk-3.1.4/test/nondec2.awk gawk-3.1.5/test/nondec2.awk
	 181 68240 diff -urN gawk-3.1.4/test/nondec2.ok gawk-3.1.5/test/nondec2.ok
	 182 68245 diff -urN gawk-3.1.4/test/nulrsend.awk gawk-3.1.5/test/nulrsend.awk
	 183 68257 diff -urN gawk-3.1.4/test/ofmtfidl.awk gawk-3.1.5/test/ofmtfidl.awk
	 184 68269 diff -urN gawk-3.1.4/test/reg/func2.out gawk-3.1.5/test/reg/func2.out
	 185 68275 diff -urN gawk-3.1.4/test/regtest.sh gawk-3.1.5/test/regtest.sh
	 186 68287 diff -urN gawk-3.1.4/test/rsstart1.awk gawk-3.1.5/test/rsstart1.awk
	 187 68323 diff -urN gawk-3.1.4/test/rsstart1.in gawk-3.1.5/test/rsstart1.in
	 188 78327 diff -urN gawk-3.1.4/test/rsstart1.ok gawk-3.1.5/test/rsstart1.ok
	 189 78332 diff -urN gawk-3.1.4/test/rsstart2.awk gawk-3.1.5/test/rsstart2.awk
	 190 78338 diff -urN gawk-3.1.4/test/rsstart2.ok gawk-3.1.5/test/rsstart2.ok
	 191 78343 diff -urN gawk-3.1.4/test/rsstart3.ok gawk-3.1.5/test/rsstart3.ok
	 192 78348 diff -urN gawk-3.1.4/test/wjposer1.awk gawk-3.1.5/test/wjposer1.awk
	 193 78427 diff -urN gawk-3.1.4/test/wjposer1.in gawk-3.1.5/test/wjposer1.in
	 194 79958 diff -urN gawk-3.1.4/test/wjposer1.ok gawk-3.1.5/test/wjposer1.ok
	 195 82030 diff -urN gawk-3.1.4/unsupported/atari/ChangeLog gawk-3.1.5/unsupported/atari/ChangeLog
	 196 82041 diff -urN gawk-3.1.4/unsupported/atari/Makefile.awklib gawk-3.1.5/unsupported/atari/Makefile.awklib
	 197 82053 diff -urN gawk-3.1.4/unsupported/atari/Makefile.st gawk-3.1.5/unsupported/atari/Makefile.st
	 198 82065 diff -urN gawk-3.1.4/unsupported/atari/config.h gawk-3.1.5/unsupported/atari/config.h
	 199 82077 diff -urN gawk-3.1.4/unsupported/atari/gawkmisc.atr gawk-3.1.5/unsupported/atari/gawkmisc.atr
	 200 82089 diff -urN gawk-3.1.4/unsupported/atari/redirect.h gawk-3.1.5/unsupported/atari/redirect.h
	 201 82101 diff -urN gawk-3.1.4/unsupported/tandem/ChangeLog gawk-3.1.5/unsupported/tandem/ChangeLog
	 202 82112 diff -urN gawk-3.1.4/unsupported/tandem/config.h gawk-3.1.5/unsupported/tandem/config.h
	 203 82124 diff -urN gawk-3.1.4/unsupported/tandem/tmisc.c gawk-3.1.5/unsupported/tandem/tmisc.c
	 204 82136 diff -urN gawk-3.1.4/version.c gawk-3.1.5/version.c
	 205 82147 diff -urN gawk-3.1.4/version.in gawk-3.1.5/version.in
	 206 82158 diff -urN gawk-3.1.4/vms/ChangeLog gawk-3.1.5/vms/ChangeLog
	 207 82225 diff -urN gawk-3.1.4/vms/descrip.mms gawk-3.1.5/vms/descrip.mms
	 208 82237 diff -urN gawk-3.1.4/vms/gawkmisc.vms gawk-3.1.5/vms/gawkmisc.vms
	 209 82249 diff -urN gawk-3.1.4/vms/redirect.h gawk-3.1.5/vms/redirect.h
	 210 82261 diff -urN gawk-3.1.4/vms/vms-conf.h gawk-3.1.5/vms/vms-conf.h
	 211 82624 diff -urN gawk-3.1.4/vms/vms_args.c gawk-3.1.5/vms/vms_args.c
	 212 82636 diff -urN gawk-3.1.4/vms/vms_fwrite.c gawk-3.1.5/vms/vms_fwrite.c
	 213 82648 diff -urN gawk-3.1.4/vms/vms_gawk.c gawk-3.1.5/vms/vms_gawk.c
	 214 82686 diff -urN gawk-3.1.4/vms/vms_misc.c gawk-3.1.5/vms/vms_misc.c
	 215 82698 diff -urN gawk-3.1.4/vms/vms_popen.c gawk-3.1.5/vms/vms_popen.c
	 216 82710 diff -urN gawk-3.1.4/vms/vmsbuild.com gawk-3.1.5/vms/vmsbuild.com
	 217 82722 diff -urN gawk-3.1.4/vms/vmstest.com gawk-3.1.5/vms/vmstest.com
	 218 83186 diff -urN gawk-3.1.4/ylwrap gawk-3.1.5/ylwrap
	 219 83273 # Final cleanup

Wed Dec 14 18:57:34 2005  Arnold D. Robbins  <arnold@skeeve.com>

	* eval.c (set_BINMODE): Fix logic of test for no numeric value.
	Makes `gawk -v BINMODE=1 ...' work again. Thanks to Eli Zaretskii
	<eliz@gnu.org> for pointing out the problem.

Wed Nov 16 20:30:06 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: Test for some new features to support new loadable
	time library: check for sys/select.h header, and check for 4 functions
	(nanosleep, select, gettimeofday, and GetSystemTimeAsFileTime).

Mon Nov 14 14:02:27 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* builtin.c (format_tree): Fix buffer overflow bug when using
	printf with floating point formatting (use snprintf, check
	the return code, and increase the buffer size if necessary).

Thu Jun 30 11:52:34 2005  Arnold D. Robbins  <arnold@skeeve.com>

	* profile.c (tree_eval): Node_not: Remember to print the exclamation
	point!  Thanks to Dan Nielsen <Dan.Nielsen@corporate.ge.com>
	for the bug report.

Mon Jun 20 12:51:25 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* eval.c (calc_exp_posint): New function to implement exponentiation
	by squaring for positive integer exponents.
	(calc_exp): New function to implement exponentiation.  For integral
	exponents, it uses exponentation by squaring by calling calc_exp_posint.
	(r_tree_eval): For case Node_exp, call calc_exp to do the work.
	(op_assign): For case Node_assign_exp, call calc_exp to do the work.

Sat Apr 30 15:08:48 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* io.c (close_one): Change patch to match Arnold's patch.

Thu Apr 28 14:01:09 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* io.c (close_one): Fix bug: when searching for files to close (because
	we are out of file descriptors), we need to limit our search to files
	that were opened for writing only.

Thu Apr 28 13:58:00 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h (STREQNN): Arnold does not like the '!memcmp' style, so I
	changed it to 'memcmp == 0'.

Thu Apr 28 13:44:20 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	Patch suggested by Jean-Marc Saffroy <jean-marc.saffroy@ext.bull.net>
	on bug-gawk@gnu.org mailing list (but do not change AWKNUM type
	from double to long double at this time).
	* builtin.c (format_tree): The type for tmpval should be AWKNUM, not
	double.
	(do_strtonum): The type for 'd' should be AWKNUM, not double.

Sun Apr 24 10:03:59 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* builtin.c (tmp_integer, do_lshift, do_rshift):
	The changes I made to support 64 bit integers had some problems
	with rounding errorrs and with mantissa length. So I un-did them.
	Furthermore, Andrew suggested to change the --lint warnings.
	These warnings in do_lshift and do_rshift are now triggered when
	the shift value exceeds AWKNUM_FRACTION_BITS (previously the value
	was compared to sizeof(uintmax_t) * CHAR_BIT). 

Thu Apr 21 18:05:29 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* eval.c (r_tree_eval): Fix bug in Node_assign_concat: make sure
	concatenated string is terminated with a '\0' char.

Thu Apr 21 17:55:13 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Define new STREQNN macro for comparing two counted strings.
	* array.c (assoc_find, do_delete): Use new STREQNN macro instead
	of STREQN.  This fixes a possible bug in multi-byte encodings where
	strings could have embedded 0 bytes.
	(strhash_get, strhash_delete): Use new STREQNN macro instead of
	calling memcmp directly.

Wed Apr 20 18:23:19 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* builtin.c (tmp_integer):
	Some users want 64 bit integers (if the environment has it).
	See the newsgroup comp.lang.awk in April 2005.
	Therefore, we have commented out the two lines that strip
	leading nonzero bits of integers which would exceed AWKNUM's size.

Mon Apr 18 16:55:19 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h (assoc_search): Declare new function.
	* array.c (assoc_search): New function to lookup a subscript
	in an array without creating it if it does not exist already.

Sun Apr 17 19:17:16 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h (strhash_delete_func): Change arguments to callback function
	to be more sensible (e.g. it is now possible to use "free" as a
	delete callback function).
	* array.c (strhash_delete): Change arguments to delete callback
	function.  And make sure to remove the element entirely from the
	hashtable before calling the function (so table is in a consistent
	state).
	(strhash_destroy): Change arguments to delete callback function, and
	do some optimization.  Make sure the table is in a consistent state
	when the callback function is called.

Sat Apr 16 16:24:52 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h (unset_ERRNO): Declare new function.
	* eval.c (unset_ERRNO): New function to set ERRNO to "".
	* io.c (do_close): Use new set_ERRNO function instead of setting
	ERRNO_node manually.  Also, remove declaration of ERRNO_node, since
	we now change it using only the helper functions.

Fri Apr 15 16:48:04 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* ext.c (load_run): In fatal messages, do not include "\n".

Fri Apr 15 16:13:52 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* array.c (strhash_create, strhash_grow): Must call memset after
	emalloc.  Unfortunately, awk.h does not define an ecalloc macro.

Fri Apr 15 12:48:22 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: Add a --disable-pgsql option for those who do
	not want to build the pgsql extension.  And remove AC_DEFINE(BUILD_XML),
	since the source code no longer checks this #ifdef (everything is done
	using the automake conditional now).  Also, change the configure
	help message to say --disable-xml instead of --enable-xml, since
	users are more likely to want to alter default behavior by saying
	--disable-xml.

Thu Apr 14 19:41:26 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: Added new --with-libpq argument.  Set automake
	conditional BUILD_PGSQL based on whether <libpq-fe.h> is found.

Thu Apr 14 18:49:20 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Declare new strhash API in array.c.  And declare new
	set_ERRNO and set_ERRNO_no_gettext functions in eval.c.
	Also declare dlload if DYNAMIC is defined.
	* eval.c (set_ERRNO, set_ERRNO_no_gettext): New functions to make
	it easier for code to manipulate the ERRNO string.
	* array.c (get_table_size): New function to calculate appropriate hash
	table size.
	(grow_table): Call new get_table_size function.
	(strhash_create, strhash_grow, strhash_get, strhash_delete,
	 strhash_destroy): New functions to implement generic string hash API.
	* awkgram.y (register_deferred_variable): Use new strhash API instead
	of managing our own linked list.
	(variable): Deferred variables are now stored in a strhash table.
	* io.c (path_save): Use new strhash API instead of managing our
	own hashtable.

Sat Apr  9 17:36:12 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* configure.ac: Modified Andrew's CONFDATE so that the timestamp
	is ISO-date-compliant.

Sat Apr  9 00:33:38 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* version.in: Change version string to start with "Extensible" to make
	it clear that this is not the same as FSF gawk.
	* main.c (version): Change the version wording a little bit.

Sat Apr  9 00:00:39 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* .cvsignore: Ignore version.c (file generated from version.in).

Fri Apr  8 23:55:32 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: Set CONFDATE to `date '+%Y%m%d'` for use in version.
	* version.in: Include CONFDATE in version_string.
	* main.c: Remove compilation date from version (the CONFDATE is now
	included in the version_string).
	* Makefile.am: Patch distdir to include $(CONFDATE).

Fri Apr  8 23:35:33 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* version.c: Removed.  This file is created from version.in by the
	configure script.
	* Makefile.am: Removed version.in from base_sources.  It is included
	in DIST_COMMON automatically.

Fri Apr  8 23:26:30 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* main.c (version): Change to handle DYNAMIC and BUILD_STATIC_EXTENSIONS
	separately.

Fri Apr  8 21:34:33 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* main.c (version): Chnaged the --version screen again.
	Now the orthogonal features DYNAMIC (depending on the presence
	of the file dlfcn.h) and BUILD_STATIC_EXTENSIONS (passed as
	option --enable-static-extensions to the configure script)
	are both distinguished and reported.

Fri Apr  8 20:40:39 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* main.c (version): Changed the --version screen. It distinguishes
	between static and dynamic extensions now.

Fri Apr  8 14:39:43 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: If a program name transform is in effect (e.g. if
	configure --program-prefix=xml is being used), then do not install
	symbolic links for awk and igawk, and also omit hard links for 
	gawk-$(VERSION) and pgawk-$(VERSION).

Thu Apr  7 21:15:33 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: Clean up EXTRA_DIST: do not include directories, instead
	include specific files.  That way we avoid including CVS subdirectories.
	Do not include awklib/xml in EXTRA_DIST, since this should be handled
	in awklib/Makefile.am.  Also remove extension from EXTRA_DIST, since
	extension is now included in SUBDIRS.  But do include XMLChangeLog
	in EXTRA_DIST.  In SUBDIRS, we must build "." before "awklib", since
	awklib now uses the compiled gawk binary to create the awklib/eg tree.
	Remove obsolete dist-hook (now handled by extension/Makefile.am).

Thu Apr  7 21:11:27 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* .cvsignore: Ignore *gawk-*.tar.gz and *gawk-*.tar.bz2 (results of
	make dist).

Thu Apr  7 14:48:32 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: Fix bug in "make clean" when configured
	with --enable-static-extensions.

Wed Apr  6 20:52:09 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: Change order of LDADD to try to fix Cygwin linking
	problems.

Mi Apr  6 17:02:29 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* Makefile.am (distdir): We use an 'x' as prefix for package name.
	* Makefile.am (awklib/xml): We include this directory into the distribution.

Tue Apr  5 03:07:22 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: Clean up the support for static extensions by moving all
	the logic into extension/Makefile.am.  Build source code files
	ext.init and ext.decl automatically, and make sure to clean them.
	* .cvsignore: Ignore generated files ext.decl and ext.init.
	* ext.c: Do not list all the extensions.  Instead, include ext.decl
	and ext.init which are created automatically by the Makefiles.

Mon Apr  4 21:00:38 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: New option --enable-static-extensions controls whether
	extension libraries are statically linked into the main gawk binary.
	Changed --enable-xml to simply control whether xml is built
	(default is to build if expat.h is found).  And added a
	--with-expat=PATH option to help find expat if it is not in the
	default location.
	* Makefile.am: If BUILD_STATIC_EXTENSIONS is defined, then link
	statically with all the extension libraries (including XML if BUILD_XML
	is defined).
	* awk.h, main.c: Remove #ifdef BUILD_XMLGAWK code.
	* ext.c: If BUILD_STATIC_EXTENSIONS is defined, then support statically
	linked extension libraries.

Mon Apr  4 16:05:59 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awklib/.cvsignore: Add eg and stamp-eg.
	* awklib/stamp-eg: Remove this file from CVS, since it is created
	by the Makefile.

Mon Apr  4 16:05:59 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awklib/eg: Remove this whole tree, since it is automatically
	generated from examples in the documentation .texi files.
	* awklib/Makefile.am: Restore original rule for stamp-eg that
	removes the whole eg directory tree.

Sun Apr  3 17:11:11 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* Makefile.am:
	* awklib/Makefile.am:
	The files awklib/eg/lib/pwcat.c and awklib/eg/lib/grcat.c are
	generated files and they are needed for compilation. Therefore,
	awklib must be made before the root directory. Also, the targets
	pwcat and grcat in awklib/Makefile.am depend on the target
	stamp-eg because of creation of generated files.

Sun Apr  3 15:34:21 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* awklib/eg/data: Removed all files generated from gawk.texi.
	* awklib/eg/lib:  Removed all files generated from gawk.texi.
	* awklib/eg/misc: Removed all files generated from gawk.texi.
	* awklib/xml:     This new directory contains the libraries
	for the XML extension.

Sun Apr  3 15:15:31 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* awklib/Makefile.am(stamp-eg): The removal of directory eg during
	the build process was not a good idea. Especially when working
	with CVS. As a temporary solution, I replaced the command line doing
	this with another one.

	* awklib/eg/prog: Removed all files generated from gawk.texi.
	* awklib/eg/network: Removed all files generated from gawkinet.texi.

Fri Apr  1 15:40:25 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: Need to uninstall igawk also.

Fri Apr  1 14:57:18 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: Change description of --enable-xml option to reflect
	that it just controls whether the XML extension is statically linked or
	dynamically loaded.  Would it be better to change the option name
	to --enable-staticxml?

Fri Apr  1 14:22:59 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: make install now creates a symbolic link from igawk
	to gawk.

Thu Mar 31 16:47:17 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: Fix it to work properly when configured with --enable-xml
	and xml support is compiled in statically.  The trick is to cd
	into the extension subdirectory and build the static libxml there.
	Then we can just link the static library into the gawk binary.
	* configure.ac: Added AC_SUBST(libext) so Makefile.am knows what
	extension to use for static libraries.
	* configure, configh.in: Removed.  These files are generated
	automatically by autotools.
	* .cvsignore: Added configure and configh.in.

Wed Mar 30 16:02:52 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.in, awklib/Makefile.in, doc/Makefile.in,
	extension/Makefile.in, test/Makefile.in: Remove files that should
	be generated from Makefile.am.
	* .cvsignore, awklib/.cvsignore, doc/.cvsignore, extension/.cvsignore,
	test/.cvsignore: Add Makefile.in.

Tue Mar 29 18:59:27 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* Makefile.am (extension): Changed the order of building.
	Now, extensions are built before the tests, so that extension
	can be tested. Inserted compilation of character encodings that
	Expat does not know.

Mon Mar 28 21:32:57 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* xml_puller.[ch], xml_interface.c: Moved to extension subdirectory.

Mon Mar 28 20:37:26 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: If BUILD_XMLGAWK is enabled, compile xml code
	from the extension subdirectory.

Mon Mar 28 19:05:18 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h (path_open_func): Obsolete function removed.
	(path_find): New function to replace path_open_func while keeping
	track of which files have already been loaded.
	* io.c (path_open_func): Removed.
	(path_save): New function to store loaded files in a hash table.
	(path_find): Find the file to be loaded, and return information
	indicating whether it was already loaded.
	(do_open): Remove obsolete function.
	(pathopen): Call path_find instead of path_open_func.  If do_lint
	is on, issue a warning message if the file was already loaded.
	* ext.c (do_dlopen): Remove obsolete function.
	(load_run): Call path_find instead of path_open_func.  If do_lint
	is on, issue a warning message if the file was already loaded.
	(load_extension): Add a warning message if do_lint is on.
	* awkgram.y (get_src_buf): If file was already loaded, just skip
	to the next source.
	* main.c (main): Fix error message to reflect change from '-e' to '-l'.

Mon Mar 28 18:14:50 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* extension/XMLChangeLog: We need a separate XMLChangeLog for the
	extension directory.

Mon Mar 28 17:44:40 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* extension/Makefile.am: Rename libdl to libzaxxon to avoid confusion
	with system library libdl.  Do not install test libraries.
	* extension/dl.c: Remove (renamed to zaxxon.c).
	* extension/zaxxon.c: Add (renamed from dl.c).

Mon Mar 28 03:42:38 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* extension/Makefile.am: Oops, should really use INSTALL_PROGRAM,
	that way "make install-strip" will work.  Add message showing
	where each library is being installed.

Mon Mar 28 03:27:55 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* extension/Makefile.am: Use $(INSTALL) instead of $(install_sh) -c.
	
Mon Mar 28 02:01:40 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* extension/Makefile.am: Add hooks to choose which libraries to
	install.  For now, install them all.

Mon Mar 28 01:53:35 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* extension/Makefile.am: Use a custom install rule to install only
	the shared libraries with the names that we want.  I'm not sure
	whether this is 100% portable...

Sun Mar 27 20:52:13 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* extension/Makefile.am: Now all extensions are compiled to shared libs.

Sun Mar 27 20:23:07 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* extension/Makefile.am: Fix installation directory, and remove -lexpat
	dependency.

Sun Mar 27 18:49:17 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>
	
	* update-autotools: New script to simulate autoreconf -i.

Sun Mar 27 17:02:14 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>
	
	* extension/Makefile: Removed.  Now using automake/libtool.

Sun Mar 27 17:02:14 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* configure.ac: Add AC_SUBST(shlibext) and AC_PROG_LIBTOOL, and
	build extension/Makefile.
	* Makefile.am: Add extension to SUBDIRS, and define SHLIBEXT.
	* extension/Makefile.am: First pass at libtool Makefile.am.

Sun Mar 27 16:59:44 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* .cvsignore: Add some libtool stuff.
	* extension/.cvsignore: New file.

Sun Mar 27 16:13:52 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h (path_open_func): New function for searching a path for a file
	and trying a possible default suffix.
	* io.c (do_pathopen): Remove obsolete function.
	(path_open_func): New more general function to search a path for a
	file and try with a default suffix.
	(pathopen): Use path_open_func instead of obsolete do_pathopen.
	(do_open): New helper function for use with path_open_func.
	* ext.c (do_dlopen): New helper function for use with path_open_func.
	(path_dlopen): Remove obsolete function, use path_open_func instead.
	(load_run): Use new function path_open_func instead of path_dlopen.

Sat Mar 26 16:09:11 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awkgram.y: Introduce input_state structure to contain lexer input
	state; this allows us to push include file state on top of underlying
	state.  Define old static variables as fields of the current
	input_state structure at the top of the stack.
	(get_src_buf): Modify behavior to support include files.
	(push_include_file): New function to push an include file on top
	of the input stack used by get_src_buf.
	(yylex): Implement support for @include by calling push_include_file.

Fri Mar 25 19:27:07 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* main.c (main): Load shared libraries using -l (--load) instead
	of -e (--extension).
	(usage): Change usage message appropriately.

Fri Mar 25 18:49:04 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awkgram.y (yylex): Implement @load directive to load a shared library.
	Also start to support @include.

Thu Mar 24 21:21:41 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* main.c (main): If -e or -i is used with --traditional or in posix
	mode, it should be a fatal error.

Thu Mar 24 14:11:57 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* main.c: I was calling xml_extension_init in the wrong place.
	It is now safely inside init_vars where it belongs.

Wed Mar 23 22:57:07 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* Makefile.in (extensiondir DEFLIBPATH): Andrew introduced new
	variables for the implementation of a search path for extensions
	in shared libraries.

Wed Mar 23 21:27:41 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: Define DEFLIBPATH as @libdir@/awk/@VERSION@
	* awk.h: Declare new global variable deflibpath and new function
	in ext.c load_extension to load extensions specified on command line.
	* main.c (main): Add new gawk options: -e to load extensions, and -i to
	include source files (same as -f, except it still allows the last
	command-line argument to contain awk program code).
	(load_environ): Supply default value for AWKLIBPATH.
	* ext.c (path_dlopen): New function to use AWKLIBPATH to find
	dynamically loaded library code.
	(load_run): New function to load a library and call a given
	initialization in the library.
	(do_ext): Use load_run to load the library and call the function.
	(load_extension): New function used to process command-line -e
	arguments.  This uses load_run to load the library and run the dlload
	function.
	* posix/gawkmisc.c (deflibpath): New global variable set to the
	value of DEFLIBPATH as defined in the Makefile.
	* unsupported/tandem/tmisc.c (deflibpath): New global variable set to
	an empty string.

Wed Mar 23 16:24:31 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* xml_interface.c (xml_load_vars): Fix initialization bug (XMLMODE
	should not be set to Nnull_string).  Also, when loaded as an extension,
	the default value of XMLMODE should be non-zero.  For now, I am setting
	it to -1, but we may later decide that 1 is more appropriate.
	Also, if BUILD_XMLGAWK is not defined, it should be safe to assume
	that xml_interface.c is being compiled as part of a shared library
	extension.

Wed Mar 23 13:38:46 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>
	With these patches, the implementation of the --enable-xml
	configuration option should be complete and working.
	A special "thank you" to Mike Frysinger for pointing me to
	the use of the autoheader tool and supplying his autogen.sh.

	* Makefile.am (xml_puller.h xml_puller.c xml_interface.c): These files
	are now compiled only when BUILD_XMLGAWK is set.
	* Makefile.in (xml_puller.h xml_puller.c xml_interface.c): This file
	is generated, don't touch it.
	* aclocal.m4: This file is generated, don't touch it.
	* awk.h (BUILD_XMLGAWK): Removed the manually inserted macro
	BUILD_XMLGAWK because we have a proper solution now.
	* configh.in: This file is generated, don't touch it.
	* configure:  This file is generated, don't touch it.
	* configure.ac: Now that autoheader works correctly,
	macros AC_CHECK_HEADER and AC_MSG_ERROR can be used.
	Thanks to Mike for this patch.
	* awklib/Makefile.in: This file is generated, don't touch it.
	* doc/Makefile.in: This file is generated, don't touch it.
	* test/Makefile.in: This file is generated, don't touch it.

Tue Mar 22 19:02:15 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Eliminate all XML-specific stuff and replace with abstract,
	general hooks for installing an input processor.  So struct xml
	is removed from IOBUF and replaced with 3 pointers: void *opaque,
	int (*get_record), and void (*close_func).
	(register_deferred_variable): Declare function to register variables
	like "ENVIRON" and "PROCINFO" and "XMLMODE" that are created only
	after they are encountered by the parser.
	(register_open_hook): Allows calling code to set a function to be called
	every time a new input source is opened.  This function can then decide
	whether a file should be opened as an XML structured file or as
	a plain text file.
	(load_environ, load_procinfo): Remove prototypes: these functions are
	now static to main.c since the new register_deferred_variable API is
	being used.
	* awkgram.y (register_deferred_variable): New function to register
	variables that should be created only after they are encountered
	by the parser.
	(variable): Update logic to use new deferred variable mechanism
	instead of hard-coding PROCINFO, ENVIRON, and XMLMODE.
	* main.c (load_environ, load_procinfo): These functions are now static.
	(main): #ifdef BUILD_XMLGAWK, call xml_extension_init().
	(init_vars): Call register_deferred_variable for PROCINFO and ENVIRON.
	* io.c (iop_close): Remove XML-specific code and instead just call
	iop->close_func if it's not NULL.
	(register_open_hook): New function to set a function to be called
	every time a new file is opened.
	(iop_alloc): Remove XML-specific code and instead call any registered
	open hook functions.
	(get_a_record): Remove XML-specific code and instead just call
	iop->get_record if it's not NULL.
	* xml_interface.c: Must include xml_puller.h, since it is no longer
	included by awk.h.  Declare struct xml_state.  XMLMODE_node is no
	longer global.
	(xml_extension_init): New function to use when XML compiled into gawk.
	(dlload): New function called when loading as a dynamic module.
	(xml_load_vars): Call register_open_hook(xml_iop_open).  Do not assume
	that XMLMODE does not exist, since it could if dynamic loading is
	being used.
	(xml_iop_open): Must malloc struct xml_state and set IOBUF methods.
	(xml_iop_close): Must free struct xml_state.

Mon Mar 21 17:11:45 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>
	This is the first step to a configurable XML build process.
	I followed Mike Frysinger's hints and inserted an argument --enable-xml
	for the "configure" script. Just like Mike, I ran into problems
	with the automake tool in the midst of all this. Therefore, the
	macro BUILD_XMLGAWK is not yet passed properly from "configure"
	to the Makefile. To keep things compiling, I have inserted a
	#define into awk.h and hope to fix this real soon.
	* Makefile.am (LDADD): New argument @XMLGAWK_LIBS@ passes -lexpat
	* Makefile.in (@XMLGAWK_LIBS@, DEPDIR): New argument @XMLGAWK_LIBS@
	passes -lexpat now. In a lucky moment, my autoconf 1.9 produced a
	sensible way of handling DEPDIR.
	* awk.h (BUILD_XMLGAWK): Defined a macro to keep things going.
	* configure (--enable-xml): This option is switched off by default.

Mon Mar 21 14:03:05 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Put `#ifdef BUILD_XMLGAWK' around all XML-related code.
	* awkgram.y (variable): Add `#ifdef BUILD_XMLGAWK'.
	* io.c (iop_close, iop_alloc, get_a_record): Add `#ifdef BUILD_XMLGAWK'.
	* main.c (version):  Add `#ifdef BUILD_XMLGAWK'.

Mon Mar 21 13:42:09 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h (NODETYPE): Remove Node_XMLMODE (we do not need a special type).
	(XMLMODE): Remove global variable (no longer used).
	(set_XMLMODE): Remove obsolete function.
	* awkgram.y (isnoeffect, isassignable) Remove case for Node_XMLMODE.
	* eval.c (nodetypes, r_tree_eval, r_get_lhs) Remove Node_XMLMODE.
	* profile.c (tree_eval, pp_lhs, is_scalar, prec_level): Remove
	Node_XMLMODE.
	* io.c (iop_alloc): XMLMODE has been removed.  Instead, just call
	xml_iop_open if XMLMODE_node is non-NULL, and let xml_iop_open decide
	whether XML is in use.
	* xml_interface.c (xml_load_vars): Change type of XMLMODE from
	Node_XMLMODE to Node_var.
	(set_XMLMODE): Remove obsolete function.
	(xml_iop_open): Decide whether to use XML parsing by testing
	value of force_number(XMLMODE_node->var_value).

Sun Mar 20 22:09:05 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* Makefile.am (AM_MAKEFLAGS, LDADD): Moved -lexpat to a more
	appropriate place from AM_MAKEFLAGS to LDADD.
	Inserted @SOCKET_LIBS@ into LDADD again because at least Solaris
	really needs it (says Andrew).
	* Makefile.in (AM_MAKEFLAGS, LDADD): The same changes as above.
	The problem with -liconv (for Cygwin) remains unsolved.

Sun Mar 20 20:58:54 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Fix XML function prototypes to use P.  Declare new function
	xml_load_vars and remove obsolete xml_init_vars.
	* awkgram.y (variable): If XMLMODE is referenced and undefined,
	call xml_load_vars.
	* main.c (init_vars): Remove call to xml_init_vars, since the variables
	are now created only after XMLMODE is encountered by the parser.
	* xml_interface.c (varinit): Add XMLCHARSET to array, since it is
	initialized the same way as the other variables.
	(xml_init_vars): Removed obsolete function.
	(xml_load_vars): New function called when XMLMODE is encountered
	by the parser.  It creates all the XML-related variables.
	(resetXMLvars): Add #ifdef'ed out code to reset variables using
	an array of pointers to XML scalar variables.  The #ifdef'ed code
	is more elegant, but it turns out to be slower than the existing
	(ugly) approach.

Sun Mar 20 16:44:28 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>
	* Makefile.in: Manually added some lines about dependencies.
	Now, the build process is OK again and all test cases also.

Sat Mar 19 23:31:47 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* Makefile.am: Added -lexpat in an inappropriate place
	and kicked out @SOCKET_LIBS@ because it produced error
	messages with my automake-1.9.1-4.
	* Makefile.in: This is the file generated from Makefile.am.
	The problem with -liconv (for Cygwin) remains unsolved.
	Test case strtod now fails.

Sat Mar 19 18:36:46 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* Makefile.am: Add xml_interface.c to base_sources.
	* xml_interface.c: New file containing the interface between gawk
	and the XML puller parser.
	* awk.h: Remove declarations for most XML variables, since they are
	now local to xml_interface.c (except for XMLMODE_node).
	Declare new functions provided by xml_interface.c: xml_init_vars,
	xml_iop_open, xml_iop_close, and xml_get_record.
	* eval.c (set_XMLMODE): Function moved to xml_interface.c.
	* io.c (iop_close): To free XML resources, just call xml_iop_close.
	(resetXMLvars, update_xmlattr, get_xml_string, set_xml_attr,
	 get_xml_record): Functions moved to xml_interface.c
	(iop_alloc): Call xml_iop_open to set up XML parser.
	* main.c: Remove all XML variable declarations (now in xml_interface.c).
	(init_vars): Call xml_init_vars to create XML variables.

Thu Mar 17 23:23:42 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* eval.c (set_BINMODE, set_XMLMODE): Fix spelling of "arbitrary".

Thu Mar 17 23:21:17 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awkgram.y (isnoeffect): Add Node_XMLMODE to list.
	(isassignable): Add Node_XMLMODE to list.

Wed Mar 16 22:08:45 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* xml_puller.c (XML_PullerIconv): Calculate the maximum length of the
	converted string using MB_LEN_MAX (defined in <limits.h>) instead
	of the constant "4".

Wed Mar 16 19:21:25 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* main.c (init_vars): Install XMLATTR array variable.
	(main): Initialization of XMLATTR belongs in init_vars, not in main.

Wed Mar 16 18:02:08 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* main.c (main): Install XMLATTR variable before processing the
	command-line preassignments (using -v).  Previously, any value provided
	for XMLATTR on the command-line was being silently ignored.  Now, it
	will give an error.

Tue Mar 15 21:24:25 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Declare new global variable NODE *XMLNAME_node.
	* main.c (varinit): Add entry for XMLNAME_node.
	* io.c (resetXMLvars): Must reset new variable XMLNAME.
	(set_xml_attr): New function to insert an entry into the XMLATTR array.
	(get_xml_record): Add SET_NAME macro to use dupnode to set XMLNAME.
	Insert calls to SET_NAME and set_xml_attr to reflect event information
	appropriately.

Tue Mar 15 18:43:34 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Change struct iobuf xml.space from char[4] to char *.
	Add xml.string_cache[] array to save XMLEVENT string values.
	* io.c (xml_event_init): Remove function and all xml_event_* global
	variables, since the strings must be cached on a per-puller basis
	to make sure they have the correct encoding.
	(iop_close): Must free iop->xml.space and iop->xml.string_cache[*].
	(convert_xmlcharset_space): Remove obsolete function (use new
	XML_PullerIconv function instead).
	(iop_alloc): Call XML_PullerIconv to calculate iop->xml.space.
	Do not call xml_event_init, this is now handled differently.
	(get_xml_string): New function to generate encoded XMLEVENT strings.
	(get_xml_record): Change SET_EVENT macro to check the appropriate slot
	in iop->xml.string_cache[].

Tue Mar 15 17:32:48 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* xml_puller.h (XML_PullerIconv): Declare new function used to convert
	string encoding.
	* xml_puller.c (XML_PullerIconv): Rename XML_PullerAllocateAndCheck to
	XML_PullerIconv and make it public so that it can be called from gawk.

Mon Mar 14 22:04:27 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>

	* doc/XMLChangeLog: Added a separate ChangeLog for the doc of
	the XML extension.
	* test/XMLChangeLog: Added a separate ChangeLog for the
	regression tests of the XML extension.

Mon Mar 14 17:20:21 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h (update_ERRNO_saved): Declare new function that allows the
	caller to specify the errno value used for the error string.
	* eval.c (update_ERRNO_saved): New function to use saved errno value
	instead of the current value.
	(update_ERRNO): Implement by calling update_ERRNO_saved.
	* io.c (close_redir): Save errno value and call update_ERRNO_saved
	instead of update_ERRNO.
	(do_getline): Call update_ERRNO_saved instead of update_ERRNO.
	But do not call update_ERRNO if get_a_record returns with errcode
	set to -1.
	(get_xml_record): If the XML parser indicated an error, and the
	errcode pointer is non-NULL, set errcode to -1 so that getline
	will return -1.

Mon Mar 14 16:25:31 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* io.c (get_xml_record): Set ERRNO to have same value as XMLERROR.

Sun Mar 13 21:19:14 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* xml_puller.h: Add new error_len field XML_Puller structure (since
	error string is now encoded and counted).
	* xml_puller.c: Improve internal_error() messages throughout.
	(XML_PullerSetError): Add a standard prefix for expat errors ["Expat
	XML Parser error:"].  Check that expat error string is non-NULL.
	Call XML_PullerAllocateAndCheck to convert the error message to the
	proper encoding.
	(internal_error): Call XML_PullerAllocateAndCheck to convert the error
	message to the proper encoding.
	(XML_PullerFree): Must free puller->error (now that it is allocated).
	* io.c (get_xml_record): Make sure puller error string is not NULL.
	The error string is now encoded and counted and malloced, so just
	steal it (instead of copying).

Sun Mar 13 19:43:40 UTC 2005 Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Remove NODETYPE Node_XMLCHARSET.  And remove declaration
	of set_XMLCHARSET.
	* eval.c (nodetypes): Remove Node_XMLCHARSET.
	(r_tree_eval, r_get_lhs) Remove case for Node_XMLCHARSET.
	(set_XMLCHARSET) Remove empty (unused) function.
	* main.c (varinit): Change type of XMLCHARSET_node from Node_XMLCHARSET
	to Node_var.
	* profile.c (tree_eval, pp_lhs, is_scalar, prec_level) Remove case
	for Node_XMLCHARSET.

Sun Mar 13 14:47:57 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>
	* doc/xmlgawk.texi: Inserted menu items for each chapter
	to stop makeinfo from whining.

Sat Mar 12 23:05:35 UTC 2005  Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awkgram.y (variable): Remove special check for XMLATTR since
	it is created immediately at program startup (not on a delayed
	basis like PROCINFO and ENVIRON).

Sa Mar 12 21:47:01 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>
	* doc/.cvsignore Now all .info, .html, .ps and .dvi files are
	ignored (not only those generated from xmlgawk).

Sa Mar 12 21:38:02 UTC 2005 Juergen Kahrs <jkahrs@users.sourceforge.net>
	* doc/Makefile.am, doc/Makefile.in
	* With these files checked in, it is now possible to produce
        xmlgawk.ps and xmlgawk.html. The whole process is not quite
	clean yet. make html fails at first sight, but the file is
	created and usable. After a fresh cvs co of xmlgawk, the first
	make in the top directory will fail for some reason in the doc
	directory. Furthermore, gawk.texi has some problems. But all
	this sounds worse than it is because everything is produced
	correctly anyay.

Sat Mar 12 20:58:52 UTC 2005  Juergen Kahrs <jkahrs@users.sourceforge.net>
	* doc/fdl.texi The file doc/fdl.texi is included by doc/xmlgawk.texi.
	* doc/awk_proc.eps doc/docbook_chapter.eps doc/rss_inq.eps
	doc/soap_error.eps doc/soap_reply.eps doc/soap_request.eps
	are new files used by doc/xmlgawk.texi.
	* doc/xmlgawk.texi The .eps files have been checked in under
	slightly different names.

Sat Mar 12 20:36:54 UTC 2005  Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* xml_puller.c (XML_PullerNext): If read returns -1, we should set
	puller status to XML_STATUS_ERROR to indicate that there was an I/O
	error.

Sat Mar 12 20:23:26 UTC 2005  Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* awk.h: Declare XMLEVENT_node.
	* main.c: New global variable XMLEVENT_node.
	(varinit) Added entry for XMLEVENT.
	* io.c: Add static xml_event_* variables to cache XMLEVENT values.
	(resetXMLvars): Must reset new XMLEVENT variable.
	(iop_alloc): If opening an XML file, check whether xml_event_* variables
	have been initialized yet; if not, call xml_event_init.
	(xml_event_init): New function to initialize xml_event_* variables.
	(get_xml_record): For each kind of token returned by XML_PullerNext,
	set an appropriate value for XMLEVENT.

Sat Mar 12 18:37:14 UTC 2005  Andrew J. Schorr <ajschorr@users.sourceforge.net>

	* .cvsignore: Ignore changes in awkgram.c.
	* doc/.cvsignore: Ignore various files produced from the texinfo
	  source documentation.

Wed Mar  9 20:07:35 UTC 2005  Juergen Kahrs <jkahrs@users.sourceforge.net>
	* doc/xmlgawk.texi: Initial checkin. PostScript file
          and Makefile changes will follow later.

Wed Mar  9 20:24:04 UTC 2005  Juergen Kahrs <jkahrs@users.sourceforge.net>
	This source tree is based on the original distribution
        ftp://ftp.gnu.org/gnu/gawk/gawk-3.1.4.tar.gz.
	Then my patch patch_3.1.4__xml_20050305 was applied.
        Then Andrew's patch dated 2005-03-07 was applied.
        * awklib/xmllib.awk: Moved this from root to here before CVS import.
        * awklib/xmltree.awk: Moved this from root to here before CVS import.

Wed Mar  9 20:12:32 UTC 2005  Juergen Kahrs <jkahrs@users.sourceforge.net> 

        * ChangeLog created.
